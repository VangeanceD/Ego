<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Life RPG</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Syncopate:<Thinking>
The text was cut off in the middle of an HTML file, specifically in the head section where font imports are being defined. I need to continue from exactly where it left off, maintaining the same formatting and structure. The cut-off point was in the middle of a font import link tag, specifically for the Syncopate font family.
</Thinking>

family=Rajdhani:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800;900&family=Syncopate:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary: #00b7ff;
            --primary-dark: #0077ff;
            --primary-light: #00ffff;
            --accent: #00ffaa;
            --background: #000814;
            --card-bg: rgba(0, 20, 40, 0.7);
            --border-glow: rgba(0, 183, 255, 0.5);
            --text-glow: rgba(0, 183, 255, 0.7);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            font-family: 'Rajdhani', sans-serif;
            background-color: var(--background);
            color: white;
            overflow-x: hidden;
            height: 100%;
            width: 100%;
        }

        .orbitron {
            font-family: 'Orbitron', sans-serif;
        }

        .syncopate {
            font-family: 'Syncopate', sans-serif;
        }

        /* Animations */
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        @keyframes pulse-glow {
            0% { box-shadow: 0 0 5px rgba(0, 183, 255, 0.3); }
            50% { box-shadow: 0 0 25px rgba(0, 183, 255, 0.7); }
            100% { box-shadow: 0 0 5px rgba(0, 183, 255, 0.3); }
        }

        .pulse-glow {
            animation: pulse-glow 3s ease-in-out infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes scale {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .animate-scale {
            animation: scale 2s ease-in-out infinite;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .animate-rotate {
            animation: rotate 10s linear infinite;
        }

        @keyframes magic-glow {
            0% { 
                box-shadow: 0 0 5px rgba(0, 183, 255, 0.3);
                text-shadow: 0 0 5px rgba(0, 183, 255, 0.3);
            }
            50% { 
                box-shadow: 0 0 30px rgba(0, 183, 255, 0.8);
                text-shadow: 0 0 15px rgba(0, 183, 255, 0.8);
            }
            100% { 
                box-shadow: 0 0 5px rgba(0, 183, 255, 0.3);
                text-shadow: 0 0 5px rgba(0, 183, 255, 0.3);
            }
        }

        .magic-glow {
            animation: magic-glow 3s ease-in-out infinite;
        }

        @keyframes levelup-ring {
            0% {
                transform: scale(0.5);
                opacity: 0.8;
            }
            100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .levelup-ring {
            position: absolute;
            border: 2px solid rgba(0, 183, 255, 0.6);
            border-radius: 50%;
            animation: levelup-ring 2s ease-out forwards;
        }

        @keyframes magic-particle-float {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) rotate(var(--r));
                opacity: 0;
            }
        }

        .magic-particle {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(0, 255, 255, 0.8) 0%, rgba(0, 183, 255, 0.4) 70%, transparent 100%);
            border-radius: 50%;
            animation: magic-particle-float var(--duration) ease-out forwards;
            box-shadow: 0 0 10px rgba(0, 183, 255, 0.6);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 183, 255, 0.1);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 183, 255, 0.3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 183, 255, 0.5);
        }

        /* Text effects */
        .glow-text {
            text-shadow: 0 0 10px rgba(0, 183, 255, 0.5);
        }

        /* Border animations */
        @keyframes borderGlow {
            0% {
                border-color: rgba(0, 183, 255, 0.3);
                box-shadow: 0 0 15px rgba(0, 183, 255, 0.3);
            }
            50% {
                border-color: rgba(0, 183, 255, 0.6);
                box-shadow: 0 0 25px rgba(0, 183, 255, 0.6);
            }
            100% {
                border-color: rgba(0, 183, 255, 0.3);
                box-shadow: 0 0 15px rgba(0, 183, 255, 0.3);
            }
        }

        .animate-border-glow {
            animation: borderGlow 3s ease-in-out infinite;
        }

        /* Navigation */
        .nav-icon {
            transition: all 0.3s ease;
        }

        .nav-icon:hover {
            transform: scale(1.1);
            background-color: rgba(0, 183, 255, 0.3) !important;
        }

        .nav-icon:active {
            transform: scale(0.95);
        }

        .hidden {
            display: none;
        }

        /* Cards */
        .quest-card {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .quest-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 183, 255, 0.2);
        }

        .quest-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(0, 183, 255, 0.1) 0%, transparent 70%);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .quest-card:hover::before {
            opacity: 1;
        }

        /* Buttons */
        .btn-primary {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            z-index: 1;
            font-family: 'Orbitron', sans-serif;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 183, 255, 0.2), transparent);
            transition: left 0.7s ease;
            z-index: -1;
        }

        .btn-primary:hover::before {
            left: 100%;
        }

        /* Progress bars */
        .progress-bar {
            height: 8px;
            background: rgba(0, 183, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, rgba(0, 183, 255, 0.5), rgba(0, 183, 255, 0.8));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        /* Badges */
        .level-badge {
            background: linear-gradient(135deg, rgba(0, 183, 255, 0.2), rgba(0, 183, 255, 0.4));
            border: 1px solid rgba(0, 183, 255, 0.3);
            box-shadow: 0 0 10px rgba(0, 183, 255, 0.2);
        }

        /* Stat animations */
        .stat-increase {
            animation: statIncrease 1s ease-out;
        }

        @keyframes statIncrease {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); color: #00ffff; }
            100% { transform: scale(1); }
        }

        /* Particles */
        .particles {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .particle {
            position: absolute;
            background: rgba(0, 183, 255, 0.5);
            border-radius: 50%;
            pointer-events: none;
        }

        /* Timer */
        .quest-timer {
            transition: width 1s linear;
        }

        /* Overlays */
        .quest-complete-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .quest-complete-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .quest-complete-content {
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid rgba(0, 183, 255, 0.5);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            max-width: 500px;
            transform: scale(0.8);
            transition: transform 0.5s ease;
            box-shadow: 0 0 30px rgba(0, 183, 255, 0.3);
        }

        .quest-complete-overlay.active .quest-complete-content {
            transform: scale(1);
        }

        .xp-gain {
            font-size: 2.5rem;
            font-weight: bold;
            background: linear-gradient(to right, #00b7ff, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 1rem 0;
            font-family: 'Orbitron', sans-serif;
        }

        /* Grid layouts */
        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        /* Cyberpunk borders */
        .cyberpunk-border {
            position: relative;
        }

        .cyberpunk-border::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            width: 20px;
            height: 20px;
            border-top: 2px solid rgba(0, 183, 255, 0.8);
            border-left: 2px solid rgba(0, 183, 255, 0.8);
        }

        .cyberpunk-border::after {
            content: '';
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 20px;
            height: 20px;
            border-bottom: 2px solid rgba(0, 183, 255, 0.8);
            border-right: 2px solid rgba(0, 183, 255, 0.8);
        }

        /* Solo Leveling inspired effects */
        .solo-text {
            font-family: 'Orbitron', sans-serif;
            font-weight: bold;
            letter-spacing: 1px;
            text-transform: uppercase;
            color: #00b7ff;
            text-shadow: 0 0 10px rgba(0, 183, 255, 0.7);
        }

        @keyframes solo-appear {
            0% { 
                opacity: 0;
                transform: scale(0.8);
                filter: blur(10px);
            }
            100% { 
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }

        .solo-appear {
            animation: solo-appear 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
        }

        @keyframes solo-levelup-ring {
            0% {
                transform: translate(-50%, -50%) scale(0.1);
                opacity: 0.9;
                border-width: 15px;
            }
            100% {
                transform: translate(-50%, -50%) scale(2);
                opacity: 0;
                border-width: 1px;
            }
        }

        .solo-levelup-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            background: rgba(0, 0, 0, 0.85);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .solo-levelup-container.active {
            opacity: 1;
            pointer-events: auto;
        }

        .solo-levelup-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            border: 5px solid rgba(0, 183, 255, 0.7);
            transform: translate(-50%, -50%) scale(0.1);
            box-shadow: 0 0 30px rgba(0, 183, 255, 0.5), inset 0 0 30px rgba(0, 183, 255, 0.5);
        }

        .solo-levelup-text {
            font-size: 5rem;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 20px rgba(0, 183, 255, 0.8);
            opacity: 0;
            transform: scale(0.5);
            transition: all 0.5s ease;
            font-family: 'Orbitron', sans-serif;
        }

        .solo-levelup-container.active .solo-levelup-text {
            opacity: 1;
            transform: scale(1);
        }

        .solo-levelup-subtext {
            font-size: 2rem;
            color: #00b7ff;
            text-shadow: 0 0 10px rgba(0, 183, 255, 0.8);
            margin-top: 1rem;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s ease;
            transition-delay: 0.3s;
            font-family: 'Rajdhani', sans-serif;
        }

        .solo-levelup-container.active .solo-levelup-subtext {
            opacity: 1;
            transform: translateY(0);
        }

        .solo-stat-increase {
            position: absolute;
            color: #00ffff;
            font-weight: bold;
            font-size: 1.2rem;
            text-shadow: 0 0 10px rgba(0, 183, 255, 0.8);
            pointer-events: none;
            animation: solo-stat-float 2s ease-out forwards;
        }

        @keyframes solo-stat-float {
            0% {
                opacity: 0;
                transform: translateY(0);
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                opacity: 0;
                transform: translateY(-50px);
            }
        }

        /* Magic circles */
        .magic-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: -1;
        }

        .magic-circle-ring {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            border: 1px solid rgba(0, 183, 255, 0.3);
            box-shadow: 0 0 15px rgba(0, 183, 255, 0.2);
        }

        .magic-circle-ring:nth-child(1) {
            width: 200px;
            height: 200px;
            animation: rotate 20s linear infinite;
        }

        .magic-circle-ring:nth-child(2) {
            width: 300px;
            height: 300px;
            animation: rotate 30s linear infinite reverse;
        }

        .magic-circle-ring:nth-child(3) {
            width: 400px;
            height: 400px;
            animation: rotate 40s linear infinite;
        }

        .magic-circle-symbol {
            position: absolute;
            color: rgba(0, 183, 255, 0.6);
            font-size: 1.5rem;
            text-shadow: 0 0 5px rgba(0, 183, 255, 0.5);
        }

        /* Reward creation styles */
        .reward-icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
            gap: 0.5rem;
        }

        .reward-icon-option {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            background: rgba(0, 183, 255, 0.1);
            border: 1px solid rgba(0, 183, 255, 0.2);
        }

        .reward-icon-option:hover {
            background: rgba(0, 183, 255, 0.2);
            transform: scale(1.05);
        }

        .reward-icon-option.selected {
            background: rgba(0, 183, 255, 0.3);
            border: 2px solid rgba(0, 183, 255, 0.6);
            box-shadow: 0 0 10px rgba(0, 183, 255, 0.4);
        }

        .reward-preview {
            background: rgba(0, 20, 40, 0.6);
            border: 1px solid rgba(0, 183, 255, 0.3);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 1rem;
        }

        /* Theme customization */
        .theme-option {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }

        .theme-option:hover {
            transform: scale(1.1);
        }

        .theme-option.selected {
            border: 2px solid white;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* Notifications */
        .level-up-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid rgba(0, 183, 255, 0.5);
            border-radius: 8px;
            padding: 1rem;
            z-index: 40;
            transform: translateX(120%);
            transition: transform 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 0 20px rgba(0, 183, 255, 0.4);
        }

        .level-up-notification.active {
            transform: translateX(0);
        }

        /* Timer display */
        .timer-display {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid rgba(0, 183, 255, 0.5);
            border-radius: 8px;
            padding: 0.5rem 1rem;
            z-index: 40;
            box-shadow: 0 0 20px rgba(0, 183, 255, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Orbitron', sans-serif;
        }

        /* Punishment modal */
        .punishment-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .punishment-modal.active {
            opacity: 1;
            pointer-events: auto;
        }

        .punishment-content {
            background: rgba(20, 0, 0, 0.9);
            border: 2px solid rgba(255, 50, 50, 0.5);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            max-width: 500px;
            transform: scale(0.8);
            transition: transform 0.5s ease;
            box-shadow: 0 0 30px rgba(255, 50, 50, 0.3);
        }

        .punishment-modal.active .punishment-content {
            transform: scale(1);
        }

        /* Holographic UI elements */
        .holographic-ui {
            position: relative;
            background: rgba(0, 20, 40, 0.7);
            border: 1px solid rgba(0, 183, 255, 0.5);
            border-radius: 5px;
            padding: 1rem;
            box-shadow: 0 0 15px rgba(0, 183, 255, 0.3);
            overflow: hidden;
        }

        .holographic-ui::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(0, 183, 255, 0.1) 0%, transparent 100%);
            pointer-events: none;
        }

        .holographic-ui::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, rgba(0, 183, 255, 0.8), transparent);
            animation: scan-line 3s linear infinite;
        }

        @keyframes scan-line {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        .holographic-header {
            position: relative;
            padding: 0.5rem 1rem;
            background: rgba(0, 183, 255, 0.2);
            border-bottom: 1px solid rgba(0, 183, 255, 0.5);
            margin-bottom: 1rem;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 0.9rem;
        }

        .holographic-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: rgba(0, 183, 255, 0.8);
        }

        .holographic-label {
            font-size: 0.8rem;
            color: rgba(0, 183, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.25rem;
            font-family: 'Rajdhani', sans-serif;
        }

        .holographic-value {
            font-size: 1.2rem;
            color: white;
            margin-bottom: 0.5rem;
            font-family: 'Orbitron', sans-serif;
        }

        .holographic-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        /* Intro animation */
        .intro-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: black;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            transition: opacity 1s ease;
        }

        .intro-animation.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .intro-silhouette {
            width: 300px;
            height: 400px;
            background: #000;
            position: relative;
            margin-bottom: 2rem;
            opacity: 0;
            animation: silhouette-appear 2s ease forwards;
        }

        @keyframes silhouette-appear {
            0% {
                opacity: 0;
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .intro-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 3rem;
            color: #00b7ff;
            text-shadow: 0 0 20px rgba(0, 183, 255, 0.8);
            opacity: 0;
            animation: text-appear 2s ease 1s forwards;
        }

        @keyframes text-appear {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .intro-subtext {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.5rem;
            color: white;
            opacity: 0;
            animation: text-appear 2s ease 2s forwards;
        }

        .intro-continue {
            margin-top: 2rem;
            padding: 0.75rem 2rem;
            background: rgba(0, 183, 255, 0.2);
            border: 1px solid rgba(0, 183, 255, 0.5);
            color: #00b7ff;
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0;
            animation: text-appear 2s ease 3s forwards;
        }

        /* Notification popup */
        .notification-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.9);
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid rgba(0, 183, 255, 0.5);
            border-radius: 10px;
            padding: 2rem;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: all 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
            box-shadow: 0 0 30px rgba(0, 183, 255, 0.4);
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .notification-popup.active {
            opacity: 1;
            pointer-events: auto;
            transform: translate(-50%, -50%) scale(1);
        }

        .notification-popup .header {
            font-family: 'Orbitron', sans-serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #00b7ff;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid rgba(0, 183, 255, 0.3);
        }

        .notification-popup .content {
            margin-bottom: 1.5rem;
            color: white;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.2rem;
        }

        .notification-popup .buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }

        /* Scan effect */
        .scan-effect {
            position: relative;
            overflow: hidden;
        }

        .scan-effect::after {
            content: '';
            position: absolute;
            top: -100%;
            left: 0;
            width: 100%;
            height: 200%;
            background: linear-gradient(to bottom, 
                transparent 0%, 
                rgba(0, 183, 255, 0.2) 50%, 
                transparent 100%);
            animation: scan-effect 3s ease-in-out infinite;
        }

        @keyframes scan-effect {
            0% {
                top: -100%;
            }
            100% {
                top: 100%;
            }
        }

        /* Loading spinner */
        .loading-spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid rgba(0, 183, 255, 0.3);
            border-radius: 50%;
            border-top-color: rgba(0, 183, 255, 0.8);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Auth required overlay */
        .auth-required {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .auth-required-content {
            background: rgba(0, 20, 40, 0.9);
            border: 2px solid rgba(0, 183, 255, 0.5);
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            max-width: 500px;
            box-shadow: 0 0 30px rgba(0, 183, 255, 0.4);
        }

        .auth-required-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            color: #00b7ff;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(0, 183, 255, 0.5);
        }

        .auth-required-text {
            color: white;
            margin-bottom: 2rem;
            font-size: 1.2rem;
        }

        .auth-buttons {
            display: flex;
            justify-content: center;
            gap: 1rem;
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Auth Required Overlay -->
        <div id="auth-required" class="auth-required hidden">
            <div class="auth-required-content cyberpunk-border">
                <h2 class="auth-required-title glow-text">Authentication Required</h2>
                <p class="auth-required-text">You need to log in or sign up to access Life RPG.</p>
                <div class="auth-buttons">
                    <a href="login.html" class="btn-primary pulse-glow px-6 py-3 inline-block">Login</a>
                    <a href="signup.html" class="btn-primary pulse-glow px-6 py-3 inline-block">Sign Up</a>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="auth-required">
            <div class="loading-spinner"></div>
        </div>

        <!-- Intro Animation -->
        <div id="intro-animation" class="intro-animation">
            <div class="intro-silhouette">
                <svg viewBox="0 0 100 120" width="300" height="400">
                    <defs>
                        <linearGradient id="silhouette-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                            <stop offset="0%" stop-color="#001428" />
                            <stop offset="100%" stop-color="#000000" />
                        </linearGradient>
                    </defs>
                    <path d="M50,10 C70,10 80,30 80,50 C80,65 75,75 70,85 C65,95 60,100 50,110 C40,100 35,95 30,85 C25,75 20,65 20,50 C20,30 30,10 50,10 Z" fill="url(#silhouette-gradient)"/>
                </svg>
                <div class="absolute inset-0 flex items-center justify-center">
                    <div class="w-full h-full bg-[radial-gradient(circle_at_50%_50%,rgba(0,183,255,0.15),transparent_70%)]"></div>
                </div>
            </div>
            <div class="intro-text">Yare Yare...</div>
            <div class="intro-subtext">Did you come to level up in your life?</div>
            <button id="intro-continue" class="intro-continue">Enter the System</button>
        </div>

        <!-- Particles Background -->
        <div class="particles" id="particles"></div>

        <!-- Intro Screen -->
        <div id="intro-screen" class="min-h-screen bg-black flex items-center relative overflow-hidden hidden">
            <div class="absolute inset-0 overflow-hidden">
                <div class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(0,183,255,0.15),transparent_100%)]"></div>
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-[#00b7ff] to-transparent animate-float"></div>
                <div class="absolute left-0 top-0 h-full w-1 bg-gradient-to-b from-transparent via-[#00b7ff] to-transparent animate-float"></div>
                <div class="absolute bottom-0 right-0 w-full h-1 bg-gradient-to-r from-transparent via-[#00b7ff] to-transparent animate-float" style="animation-delay: 1.5s;"></div>
                <div class="absolute right-0 top-0 h-full w-1 bg-gradient-to-b from-transparent via-[#00b7ff] to-transparent animate-float" style="animation-delay: 1.5s;"></div>
            </div>
            
            <div class="w-full flex flex-col md:flex-row justify-between items-center px-4 md:px-8 relative z-10">
                <div class="w-full md:w-1/2 text-center md:text-left pr-0 md:pr-8 mb-8 md:mb-0">
                    <div class="animate-float" style="animation-duration: 4s;">
                        <h1 class="text-5xl md:text-6xl font-bold text-white mb-4 tracking-tight glow-text solo-text orbitron">
                            <span class="text-[#00b7ff]">Life RPG</span>
                        </h1>
                        <p class="text-3xl md:text-4xl font-light text-white/80 leading-tight">
                            Are you ready to <span class="text-[#00b7ff] glow-text">level up</span> your life?
                        </p>
                    </div>
                    
                    <div class="mt-8 flex justify-center md:justify-start space-x-4">
                        <div class="animate-pulse pulse-glow rounded-full w-3 h-3 bg-[#00b7ff]"></div>
                        <div class="animate-pulse pulse-glow rounded-full w-3 h-3 bg-[#00b7ff]" style="animation-delay: 0.5s;"></div>
                        <div class="animate-pulse pulse-glow rounded-full w-3 h-3 bg-[#00b7ff]" style="animation-delay: 1s;"></div>
                    </div>
                </div>

                <div class="w-full md:w-1/2 max-w-md">
                    <div class="bg-black/50 backdrop-blur-lg p-8 rounded-lg border border-[#00b7ff]/30 animate-border-glow cyberpunk-border holographic-ui">
                        <div class="holographic-header">System Access</div>
                        <h2 class="text-2xl font-bold text-[#00b7ff] mb-6 text-center glow-text solo-text orbitron">BEGIN YOUR JOURNEY</h2>
                        <input
                            type="text"
                            id="player-name"
                            placeholder="ENTER YOUR NAME, SEEKER"
                            class="w-full px-4 py-3 bg-black/60 text-[#00b7ff] placeholder-[#00b7ff]/50 border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] tracking-wider orbitron"
                        />
                        <div class="mt-4 text-center animate-pulse">
                            <p class="text-[#00b7ff]/70 text-sm tracking-wider syncopate">PRESS ENTER TO BEGIN YOUR JOURNEY</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Layout -->
        <div id="game-layout" class="min-h-screen bg-black flex hidden">
            <!-- Side Navigation -->
            <div class="w-20 bg-black/80 border-r border-[#00b7ff]/30 flex flex-col items-center py-8 space-y-8">
                <div class="w-16 h-16 rounded-full bg-[#00b7ff]/20 flex items-center justify-center mb-4 pulse-glow" id="profile-picture-container">
                    <span id="player-initial" class="text-2xl font-bold text-[#00b7ff] orbitron">P</span>
                </div>
                
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" data-page="profile">
                    <i data-lucide="user"></i>
                </div>
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" data-page="quests">
                    <i data-lucide="sword"></i>
                </div>
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" data-page="rewards">
                    <i data-lucide="gift"></i>
                </div>
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" data-page="create-quest">
                    <i data-lucide="plus-circle"></i>
                </div>
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" data-page="create-reward">
                    <i data-lucide="trophy"></i>
                </div>
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" data-page="settings">
                    <i data-lucide="settings"></i>
                </div>
                <div class="flex-grow"></div>
                <div class="nav-icon w-12 h-12 flex items-center justify-center rounded-lg cursor-pointer text-[#00b7ff]/70 hover:bg-[#00b7ff]/20 hover:text-[#00b7ff]" id="logout-btn">
                    <i data-lucide="log-out"></i>
                </div>
            </div>

            <!-- Main Content Area -->
            <div class="flex-1 p-4 md:p-8 overflow-y-auto">
                <!-- Header with level info -->
                <div class="mb-6 bg-black/40 p-4 rounded-lg border border-[#00b7ff]/30 flex flex-col md:flex-row justify-between items-center holographic-ui">
                    <div class="flex items-center mb-4 md:mb-0">
                        <div class="level-badge w-12 h-12 rounded-full flex items-center justify-center mr-4 magic-glow">
                            <span id="header-level" class="text-xl font-bold text-[#00b7ff] orbitron">1</span>
                        </div>
                        <div>
                            <h2 id="header-name" class="text-xl font-bold text-white solo-text orbitron">Player</h2>
                            <div class="flex items-center">
                                <span id="header-rank" class="text-[#00b7ff]/70 mr-2 syncopate">Rank E</span>
                                <span id="header-xp" class="text-[#00b7ff]/70">0 XP</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="w-full md:w-1/3">
                        <div class="flex items-center justify-between mb-1">
                            <span class="text-[#00b7ff]/70 text-sm syncopate">Level Progress</span>
                            <span id="xp-progress" class="text-[#00b7ff]/70 text-sm orbitron">0/100</span>
                        </div>
                        <div class="progress-bar">
                            <div id="xp-bar" class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                </div>

                <!-- Timer display when quest is active -->
                <div id="timer-display" class="timer-display hidden">
                    <i data-lucide="timer" class="text-[#00b7ff] w-5 h-5"></i>
                    <span id="timer-text" class="text-[#00b7ff] font-mono">00:00</span>
                </div>

                <!-- Profile Page -->
                <div id="profile-page" class="page-content hidden">
                    <!-- Profile content will be dynamically populated -->
                </div>

                <!-- Quests Page -->
                <div id="quests-page" class="page-content hidden">
                    <!-- Quests content will be dynamically populated -->
                </div>

                <!-- Rewards Page -->
                <div id="rewards-page" class="page-content hidden">
                    <!-- Rewards content will be dynamically populated -->
                </div>

                <!-- Create Quest Page -->
                <div id="create-quest-page" class="page-content hidden">
                    <!-- Create Quest content will be dynamically populated -->
                </div>

                <!-- Create Reward Page -->
                <div id="create-reward-page" class="page-content hidden">
                    <!-- Create Reward content will be dynamically populated -->
                </div>

                <!-- Settings Page -->
                <div id="settings-page" class="page-content hidden">
                    <!-- Settings content will be dynamically populated -->
                </div>
            </div>
        </div>

        <!-- Quest Complete Overlay -->
        <div id="quest-complete-overlay" class="quest-complete-overlay">
            <div class="quest-complete-content holographic-ui">
                <div class="animate-rotate absolute -z-10 inset-0 opacity-20">
                    <div class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(0,183,255,0.3),transparent_70%)]"></div>
                </div>
                <h2 class="text-3xl font-bold text-[#00b7ff] glow-text solo-text orbitron">Quest Complete!</h2>
                <div class="my-4">
                    <i data-lucide="check-circle" class="w-16 h-16 text-[#00b7ff] mx-auto"></i>
                </div>
                <p id="quest-complete-title" class="text-xl text-white mb-2">Quest Title</p>
                <div class="xp-gain" id="quest-complete-xp">+100 XP</div>
                
                <div class="mt-4">
                    <p class="text-[#00b7ff]/70 mb-2 syncopate">Stats Increased:</p>
                    <div id="quest-complete-stats" class="grid grid-cols-2 gap-2">
                        <!-- Stats will be populated dynamically -->
                    </div>
                </div>
                
                <button id="quest-complete-continue" class="mt-6 px-6 py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary">
                    CONTINUE
                </button>
            </div>
        </div>

        <!-- Punishment Overlay -->
        <div id="punishment-modal" class="punishment-modal">
            <div class="punishment-content">
                <div class="animate-rotate absolute -z-10 inset-0 opacity-20">
                    <div class="absolute inset-0 bg-[radial-gradient(circle_at_50%_50%,rgba(255,50,50,0.3),transparent_70%)]"></div>
                </div>
                <h2 class="text-3xl font-bold text-red-500 mb-4 text-center orbitron">Quest Failed!</h2>
                <div class="my-4">
                    <i data-lucide="x-circle" class="w-16 h-16 text-red-500 mx-auto"></i>
                </div>
                <p id="punishment-message" class="text-xl text-white mb-6 text-center">You failed to complete the quest in time!</p>
                
                <button id="punishment-continue" class="mt-6 px-6 py-2 bg-red-900/30 hover:bg-red-900/50 text-red-400 rounded border border-red-500/30 transition-colors tracking-wider orbitron">
                    ACCEPT PUNISHMENT
                </button>
            </div>
        </div>

        <!-- Solo Leveling Style Level Up Animation -->
        <div id="solo-levelup-container" class="solo-levelup-container">
            <div class="magic-circle">
                <div class="magic-circle-ring"></div>
                <div class="magic-circle-ring"></div>
                <div class="magic-circle-ring"></div>
            </div>
            <div class="flex flex-col items-center justify-center text-center">
                <div class="solo-levelup-text solo-text orbitron">LEVEL UP!</div>
                <div class="solo-levelup-subtext" id="solo-levelup-level">Level 2</div>
            </div>
        </div>

        <!-- Level Up Notification -->
        <div id="level-up-notification" class="level-up-notification">
            <div class="flex items-center">
                <div class="mr-3">
                    <i data-lucide="arrow-up" class="w-8 h-8 text-[#00b7ff]"></i>
                </div>
                <div>
                    <h3 class="text-[#00b7ff] font-bold orbitron">Level Up!</h3>
                    <p class="text-white text-sm" id="level-up-notification-text">You've reached level 2!</p>
                </div>
            </div>
        </div>

        <!-- Notification Popup -->
        <div id="notification-popup" class="notification-popup">
            <div class="header">Notification</div>
            <div class="content" id="notification-content">This is a notification message.</div>
            <div class="buttons">
                <button id="notification-confirm" class="px-4 py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary orbitron">
                    CONFIRM
                </button>
                <button id="notification-cancel" class="px-4 py-2 bg-black/60 hover:bg-black/80 text-[#00b7ff]/70 hover:text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors orbitron">
                    CANCEL
                </button>
            </div>
        </div>
    </div>

    <script src="supabase-client.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // Player state
        let player = null;
        const XP_PER_LEVEL = 100;
        const RANKS = [
            { name: "E", level: 1 },
            { name: "D", level: 10 },
            { name: "C", level: 25 },
            { name: "B", level: 40 },
            { name: "A", level: 60 },
            { name: "S", level: 80 }
        ];

        // Theme settings
        let currentTheme = {
            primary: '#00b7ff',
            secondary: '#00ffff',
            background: 'black'
        };

        // Active quest tracking
        let activeQuest = null;
        let questTimer = null;
        let questStartTime = null;
        let timeRemaining = null;

        // Initialize the application
        async function init() {
            // Show loading overlay
            document.getElementById('loading-overlay').classList.remove('hidden');
            
            // Check authentication status
            const { data: { session } } = await supabase.auth.getSession();
            
            if (!session) {
                // User is not authenticated, show auth required overlay
                document.getElementById('loading-overlay').classList.add('hidden');
                document.getElementById('auth-required').classList.remove('hidden');
                return;
            }
            
            // User is authenticated, hide auth required overlay
            document.getElementById('auth-required').classList.add('hidden');
            
            // Fetch player data from Supabase
            await fetchPlayerData(session.user.id);
            
            // Hide loading overlay
            document.getElementById('loading-overlay').classList.add('hidden');
            
            // Handle intro animation
            const introAnimation = document.getElementById('intro-animation');
            const introContinue = document.getElementById('intro-continue');
            
            introContinue.addEventListener('click', () => {
                introAnimation.classList.add('fade-out');
                setTimeout(() => {
                    introAnimation.style.display = 'none';
                    
                    // Create particles
                    createParticles();
                    
                    // Check if player has a name
                    if (player && player.name) {
                        updateHeaderInfo();
                        showGameLayout();
                        navigateTo('profile');
                    } else {
                        showIntroScreen();
                    }
                }, 1000);
            });

            // Setup event listeners
            setupEventListeners();
        }

        async function fetchPlayerData(userId) {
            try {
                // First, check if player data exists
                const { data: playerData, error: playerError } = await supabase
                    .from('player_data')
                    .select('player_state')
                    .eq('id', userId)
                    .single();
                
                if (playerError && playerError.code !== 'PGRST116') {
                    console.error('Error fetching player data:', playerError);
                    return;
                }
                
                // Get user profile
                const { data: profile, error: profileError } = await supabase
                    .from('profiles')
                    .select('username')
                    .eq('id', userId)
                    .single();
                
                if (profileError) {
                    console.error('Error fetching profile:', profileError);
                    return;
                }
                
                if (playerData && playerData.player_state && Object.keys(playerData.player_state).length > 0) {
                    // Player data exists, use it
                    player = playerData.player_state;
                } else {
                    // Create new player data
                    player = createDefaultPlayer(profile.username);
                    
                    // Save to Supabase
                    await savePlayerData();
                }
            } catch (error) {
                console.error('Error in fetchPlayerData:', error);
            }
        }

        async function savePlayerData() {
            if (!player) return;
            
            try {
                const { data: { user } } = await supabase.auth.getUser();
                
                if (!user) {
                    console.error('No authenticated user found');
                    return;
                }
                
                const { error } = await supabase
                    .from('player_data')
                    .upsert({ 
                        id: user.id, 
                        player_state: player,
                        updated_at: new Date()
                    });
                
                if (error) {
                    console.error('Error saving player data:', error);
                }
            } catch (error) {
                console.error('Error in savePlayerData:', error);
            }
        }

        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 30;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                
                // Random size between 1 and 3px
                const size = Math.random() * 2 + 1;
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                
                // Random position
                particle.style.left = `${Math.random() * 100}%`;
                particle.style.top = `${Math.random() * 100}%`;
                
                // Random opacity
                particle.style.opacity = Math.random() * 0.5 + 0.1;
                
                // Animation
                particle.style.animation = `float ${Math.random() * 10 + 10}s linear infinite`;
                
                particlesContainer.appendChild(particle);
            }
        }

        function setupEventListeners() {
            // Name input handler
            const nameInput = document.getElementById('player-name');
            if (nameInput) {
                nameInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && nameInput.value.trim()) {
                        updatePlayerName(nameInput.value.trim());
                    }
                });
            }

            // Navigation handlers
            document.querySelectorAll('.nav-icon').forEach(icon => {
                icon.addEventListener('click', () => {
                    const page = icon.dataset.page;
                    if (page) {
                        navigateTo(page);
                    }
                });
            });

            // Logout handler
            document.getElementById('logout-btn').addEventListener('click', () => {
                showNotification(
                    'Logout Confirmation', 
                    'Are you sure you want to log out? Your progress is saved.', 
                    async () => {
                        await supabase.auth.signOut();
                        window.location.href = 'login.html';
                    }
                );
            });

            // Quest complete continue button
            document.getElementById('quest-complete-continue').addEventListener('click', () => {
                document.getElementById('quest-complete-overlay').classList.remove('active');
            });

            // Punishment continue button
            document.getElementById('punishment-continue').addEventListener('click', () => {
                document.getElementById('punishment-modal').classList.remove('active');
            });

            // Notification buttons
            document.getElementById('notification-confirm').addEventListener('click', () => {
                if (window.notificationCallback) {
                    window.notificationCallback();
                    window.notificationCallback = null;
                }
                document.getElementById('notification-popup').classList.remove('active');
            });

            document.getElementById('notification-cancel').addEventListener('click', () => {
                document.getElementById('notification-popup').classList.remove('active');
            });
        }

        function showNotification(title, message, callback = null) {
            const popup = document.getElementById('notification-popup');
            const header = popup.querySelector('.header');
            const content = document.getElementById('notification-content');
            const cancelBtn = document.getElementById('notification-cancel');
            
            header.textContent = title;
            content.textContent = message;
            
            // Store callback
            window.notificationCallback = callback;
            
            // Show/hide cancel button based on callback
            cancelBtn.style.display = callback ? 'block' : 'none';
            
            // Show popup
            popup.classList.add('active');
            
            // Create magic particles
            createMagicParticles(popup, 20);
        }

        function createDefaultPlayer(username) {
            return {
                name: username,
                level: 1,
                xp: 0,
                xpToNextLevel: XP_PER_LEVEL,
                rank: getRankForLevel(1),
                stats: {
                    strength: 1,
                    endurance: 1,
                    focus: 1,
                    discipline: 1,
                    agility: 1,
                    intelligence: 1
                },
                quests: [
                    {
                        id: '1',
                        title: 'Morning Exercise',
                        description: 'Complete a 10-minute workout to start your day energized',
                        xp: 50,
                        timeLimit: 10,
                        category: 'physical',
                        completed: false,
                        stats: ['strength', 'endurance'],
                        punishment: 'No workout today! Your muscles are getting weaker.'
                    },
                    {
                        id: '2',
                        title: 'Meditation Session',
                        description: 'Practice mindfulness meditation to improve focus',
                        xp: 30,
                        timeLimit: 5,
                        category: 'mental',
                        completed: false,
                        stats: ['focus', 'discipline'],
                        punishment: 'Your mind remains cluttered and unfocused.'
                    }
                ],
                rewards: [
                    {
                        id: '1',
                        title: 'Cheat Day',
                        description: 'Enjoy your favorite fast food without guilt',
                        cost: 100,
                        icon: 'pizza',
                        custom: false
                    },
                    {
                        id: '2',
                        title: 'Gaming Session',
                        description: '2 hours of guilt-free gaming',
                        cost: 50,
                        icon: 'gamepad-2',
                        custom: false
                    }
                ],
                completedQuests: [],
                claimedRewards: [],
                settings: {
                    theme: 'blue',
                    animations: true,
                    notifications: true
                },
                profilePicture: null
            };
        }

        async function updatePlayerName(name) {
            if (!player) {
                player = createDefaultPlayer(name);
            } else {
                player.name = name;
            }
            
            // Save to Supabase
            await savePlayerData();
            
            updateHeaderInfo();
            showGameLayout();
            
            // Show welcome notification
            showNotification(
                'Welcome, Hunter', 
                `You have acquired the qualifications to be a Player. Welcome to the system, ${player.name}.`
            );
            
            navigateTo('profile');
        }

        function getRankForLevel(level) {
            for (let i = RANKS.length - 1; i >= 0; i--) {
                if (level >= RANKS[i].level) {
                    return RANKS[i].name;
                }
            }
            return "Unranked";
        }

        function updateHeaderInfo() {
            if (!player) return;
            
            document.getElementById('header-name').textContent = player.name;
            document.getElementById('header-level').textContent = player.level;
            document.getElementById('header-rank').textContent = `Rank ${player.rank}`;
            document.getElementById('header-xp').textContent = `${player.xp} XP`;
            
            // Update XP progress bar
            const xpProgress = document.getElementById('xp-progress');
            const xpBar = document.getElementById('xp-bar');
            
            const xpForCurrentLevel = (player.level - 1) * XP_PER_LEVEL;
            const xpForNextLevel = player.level * XP_PER_LEVEL;
            const currentLevelProgress = player.xp - xpForCurrentLevel;
            const xpNeededForNextLevel = xpForNextLevel - xpForCurrentLevel;
            
            xpProgress.textContent = `${currentLevelProgress}/${xpNeededForNextLevel}`;
            xpBar.style.width = `${(currentLevelProgress / xpNeededForNextLevel) * 100}%`;
            
            // Update player initial
            document.getElementById('player-initial').textContent = player.name.charAt(0).toUpperCase();

            // Update profile picture if exists
            if (player.profilePicture) {
                const profileContainer = document.getElementById('profile-picture-container');
                profileContainer.innerHTML = `<img src="${player.profilePicture}" alt="Profile" class="w-14 h-14 rounded-full object-cover">`;
            }
        }

        function showIntroScreen() {
            document.getElementById('intro-screen').classList.remove('hidden');
            document.getElementById('game-layout').classList.add('hidden');
        }

        function showGameLayout() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('game-layout').classList.remove('hidden');
        }

        function navigateTo(page) {
            // If there's an active quest, confirm before navigating away
            if (activeQuest && page !== 'quests') {
                showNotification(
                    'Active Quest Warning', 
                    'You have an active quest in progress. Navigating away will cancel it. Continue?', 
                    () => {
                        cancelActiveQuest();
                        navigateToPage(page);
                    }
                );
                return;
            }
            
            navigateToPage(page);
        }

        function navigateToPage(page) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            const pageElement = document.getElementById(`${page}-page`);
            if (pageElement) {
                pageElement.classList.remove('hidden');
                renderPage(page);
            }

            // Update active nav state
            document.querySelectorAll('.nav-icon').forEach(icon => {
                if (icon.dataset.page === page) {
                    icon.classList.add('bg-[#00b7ff]/20', 'text-[#00b7ff]');
                } else {
                    icon.classList.remove('bg-[#00b7ff]/20', 'text-[#00b7ff]');
                }
            });
        }

        function renderPage(page) {
            switch(page) {
                case 'profile':
                    renderProfile();
                    break;
                case 'quests':
                    renderQuests();
                    break;
                case 'rewards':
                    renderRewards();
                    break;
                case 'create-quest':
                    renderCreateQuest();
                    break;
                case 'create-reward':
                    renderCreateReward();
                    break;
                case 'settings':
                    renderSettings();
                    break;
            }
        }

        function renderProfile() {
            const profileContent = `
                <div class="space-y-6">
                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">Hunter Profile</div>
                        <div class="flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6 mb-6">
                            <div class="w-24 h-24 rounded-full bg-[#00b7ff]/20 flex items-center justify-center pulse-glow scan-effect">
                                ${player.profilePicture ? 
                                    `<img src="${player.profilePicture}" alt="Profile" class="w-20 h-20 rounded-full object-cover">` :
                                    `<span class="text-4xl font-bold text-[#00b7ff] solo-text orbitron">${player.name.charAt(0).toUpperCase()}</span>`
                                }
                            </div>
                            <div class="text-center md:text-left">
                                <h2 class="text-3xl font-bold text-[#00b7ff] glow-text solo-text orbitron">${player.name}</h2>
                                <div class="flex flex-col md:flex-row md:items-center md:space-x-4">
                                    <div class="flex items-center justify-center md:justify-start space-x-2">
                                        <div class="level-badge px-3 py-1 rounded-full">
                                            <span class="text-[#00b7ff] orbitron">Level ${player.level}</span>
                                        </div>
                                        <div class="text-[#00b7ff]/70 syncopate">Rank ${player.rank}</div>
                                    </div>
                                    <div class="mt-2 md:mt-0">
                                        <div class="flex items-center justify-center md:justify-start space-x-2">
                                            <i data-lucide="star" class="w-4 h-4 text-[#00b7ff]"></i>
                                            <span class="text-[#00b7ff]/70 orbitron">${player.xp} XP</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mb-6">
                            <h3 class="text-xl font-bold text-[#00b7ff] mb-3 solo-text orbitron">Character Stats</h3>
                            <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
                                ${renderStatCard('Strength', player.stats.strength, 'sword')}
                                ${renderStatCard('Endurance', player.stats.endurance, 'shield')}
                                ${renderStatCard('Focus', player.stats.focus, 'brain')}
                                ${renderStatCard('Discipline', player.stats.discipline, 'heart')}
                                ${renderStatCard('Agility', player.stats.agility, 'dumbbell')}
                                ${renderStatCard('Intelligence', player.stats.intelligence, 'lightbulb')}
                            </div>
                        </div>

                        <div>
                            <h3 class="text-xl font-bold text-[#00b7ff] mb-3 solo-text orbitron">Achievement Progress</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                ${renderAchievement('Early Riser', 'Complete 5 morning quests', 0, 5)}
                                ${renderAchievement('Mind Master', 'Reach level 5 in Focus', player.stats.focus, 5)}
                                ${renderAchievement('Iron Will', 'Complete 10 quests', player.completedQuests ? player.completedQuests.length : 0, 10)}
                            </div>
                        </div>
                    </div>

                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">Recent Activity</div>
                        <div class="space-y-3">
                            ${player.completedQuests && player.completedQuests.length > 0 ? player.completedQuests.slice(0, 3).map(quest => `
                                <div class="bg-black/60 p-3 rounded border border-[#00b7ff]/30 flex justify-between items-center quest-card">
                                    <div>
                                        <h4 class="text-[#00b7ff] orbitron">${quest.title}</h4>
                                        <p class="text-[#00b7ff]/60 text-sm">${new Date(quest.completedAt).toLocaleString()}</p>
                                    </div>
                                    <div class="text-[#00b7ff] orbitron">+${quest.xp} XP</div>
                                </div>
                            `).join('') : `<p class="text-[#00b7ff]/60">No completed quests yet. Start your journey!</p>`}
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('profile-page').innerHTML = profileContent;
            lucide.createIcons();
        }

        function renderAchievement(title, description, current, target) {
            const percentage = Math.min(100, (current / target) * 100);
            return `
                <div class="bg-black/60 p-4 rounded border border-[#00b7ff]/30 quest-card holographic-ui">
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="text-[#00b7ff] orbitron">${title}</h4>
                        <span class="text-[#00b7ff]/70 orbitron">${current}/${target}</span>
                    </div>
                    <p class="text-[#00b7ff]/60 text-sm mb-2">${description}</p>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${percentage}%"></div>
                    </div>
                </div>
            `;
        }

        function renderStatCard(label, value, icon) {
            return `
                <div class="bg-black/60 p-4 rounded border border-[#00b7ff]/30 quest-card holographic-ui">
                    <div class="flex items-center space-x-2 text-[#00b7ff]/80">
                        <i data-lucide="${icon}" class="w-5 h-5"></i>
                        <span class="syncopate">${label}</span>
                    </div>
                    <p class="text-2xl font-bold text-[#00b7ff] mt-2 orbitron">${value}</p>
                </div>
            `;
        }

        function renderQuests() {
            // Group quests by category
            const categories = {
                physical: { icon: 'dumbbell', name: 'Physical' },
                mental: { icon: 'brain', name: 'Mental' },
                health: { icon: 'heart', name: 'Health' },
                other: { icon: 'list', name: 'Other' }
            };

            let questsByCategory = {};
            
            player.quests.forEach(quest => {
                const category = quest.category || 'other';
                if (!questsByCategory[category]) {
                    questsByCategory[category] = [];
                }
                questsByCategory[category].push(quest);
            });

            let questsContent = `
                <div class="space-y-6">
                    ${activeQuest ? renderActiveQuest() : ''}
                    
                    <div class="flex justify-between items-center">
                        <h2 class="text-2xl font-bold text-[#00b7ff] glow-text solo-text orbitron">Available Quests</h2>
                        <button 
                            onclick="navigateTo('create-quest')" 
                            class="px-4 py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider flex items-center space-x-2 btn-primary"
                        >
                            <i data-lucide="plus" class="w-4 h-4"></i>
                            <span>NEW QUEST</span>
                        </button>
                    </div>
            `;

            // Render quests by category
            for (const [category, quests] of Object.entries(questsByCategory)) {
                if (quests.length === 0) continue;
                
                const categoryInfo = categories[category] || categories.other;
                
                questsContent += `
                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border mt-4 holographic-ui">
                        <div class="holographic-header">
                            <div class="flex items-center space-x-2">
                                <i data-lucide="${categoryInfo.icon}" class="text-[#00b7ff] w-5 h-5"></i>
                                <span class="orbitron">${categoryInfo.name} Quests</span>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${quests.filter(q => !q.completed).map(quest => `
                                <div class="bg-black/60 p-4 rounded border border-[#00b7ff]/30 quest-card holographic-ui" id="quest-${quest.id}">
                                    <div class="flex justify-between items-center">
                                        <h3 class="text-lg font-semibold text-[#00b7ff] orbitron">${quest.title}</h3>
                                        <div class="flex items-center space-x-2">
                                            <i data-lucide="star" class="w-4 h-4 text-[#00b7ff]/70"></i>
                                            <span class="text-[#00b7ff]/70 orbitron">${quest.xp} XP</span>
                                        </div>
                                    </div>
                                    <p class="text-[#00b7ff]/60 mt-2">${quest.description}</p>
                                    <div class="flex flex-wrap items-center mt-2 space-x-3">
                                        <div class="flex items-center">
                                            <i data-lucide="timer" class="text-[#00b7ff]/70 w-4 h-4 mr-1"></i>
                                            <span class="text-[#00b7ff]/60 orbitron">${quest.timeLimit} min</span>
                                        </div>
                                        ${quest.stats ? `
                                            <div class="flex items-center space-x-1">
                                                ${quest.stats.map(stat => `
                                                    <span class="px-2 py-0.5 bg-[#00b7ff]/10 text-[#00b7ff]/70 rounded text-xs syncopate">${stat}</span>
                                                `).join('')}
                                            </div>
                                        ` : ''}
                                    </div>
                                    <button
                                        onclick="startQuest('${quest.id}')"
                                        class="mt-4 w-full py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary ${activeQuest ? 'opacity-50 cursor-not-allowed' : ''}"
                                        ${activeQuest ? 'disabled' : ''}
                                    >
                                        ${activeQuest ? 'QUEST IN PROGRESS' : 'START QUEST'}
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            questsContent += `</div>`;

            document.getElementById('quests-page').innerHTML = questsContent;
            lucide.createIcons();
        }

        function renderActiveQuest() {
            return `
                <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] mb-6 animate-border-glow cyberpunk-border holographic-ui">
                    <div class="holographic-header">
                        <div class="flex justify-between items-center">
                            <span class="orbitron">Active Quest</span>
                            <div class="flex items-center space-x-2">
                                <i data-lucide="star" class="w-4 h-4 text-[#00b7ff]/70"></i>
                                <span class="text-[#00b7ff]/70 orbitron">${activeQuest.xp} XP</span>
                            </div>
                        </div>
                    </div>
                    
                    <h4 class="text-lg font-semibold text-[#00b7ff] mb-2 orbitron">${activeQuest.title}</h4>
                    <p class="text-[#00b7ff]/60 mb-4">${activeQuest.description}</p>
                    
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <span class="text-[#00b7ff]/70 text-sm syncopate">Time Remaining</span>
                            <span id="quest-timer" class="text-[#00b7ff]/70 text-sm orbitron">${formatTime(timeRemaining)}</span>
                        </div>
                        <div class="progress-bar">
                            <div id="quest-timer-bar" class="progress-fill quest-timer" style="width: ${(timeRemaining / (activeQuest.timeLimit * 60)) * 100}%"></div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3">
                        <button
                            onclick="completeQuest()"
                            class="flex-1 py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary"
                        >
                            COMPLETE QUEST
                        </button>
                        <button
                            onclick="cancelActiveQuest()"
                            class="py-2 px-4 bg-black/60 hover:bg-black/80 text-[#00b7ff]/70 hover:text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors"
                        >
                            <i data-lucide="x" class="w-5 h-5"></i>
                        </button>
                    </div>
                </div>
            `;
        }

        function startQuest(questId) {
            // Find the quest
            const quest = player.quests.find(q => q.id === questId);
            if (!quest) return;
            
            // Set as active quest
            activeQuest = quest;
            questStartTime = Date.now();
            
            // Start the timer
            startQuestTimer(quest.timeLimit);
            
            // Show timer display
            const timerDisplay = document.getElementById('timer-display');
            timerDisplay.classList.remove('hidden');
            
            // Re-render quests page
            renderQuests();

            // Create magic particles effect
            createMagicParticles(document.getElementById(`quest-${questId}`), 30);
            
            // Show notification
            showNotification('Quest Started', `You have started the quest: ${quest.title}. Complete it within ${quest.timeLimit} minutes to earn rewards!`);
        }

        function startQuestTimer(minutes) {
            // Clear any existing timer
            if (questTimer) {
                clearInterval(questTimer);
            }
            
            const totalSeconds = minutes * 60;
            timeRemaining = totalSeconds;
            const timerBar = document.getElementById('quest-timer-bar');
            
            // Update timer immediately
            updateQuestTimer(timeRemaining, totalSeconds);
            
            // Set up interval
            questTimer = setInterval(() => {
                timeRemaining--;
                updateQuestTimer(timeRemaining, totalSeconds);
                
                if (timeRemaining <= 0) {
                    clearInterval(questTimer);
                    // Handle quest failure when timer ends
                    handleQuestFailure();
                }
            }, 1000);
        }

        function updateQuestTimer(secondsRemaining, totalSeconds) {
            const timerElement = document.getElementById('quest-timer');
            const timerBar = document.getElementById('quest-timer-bar');
            const timerText = document.getElementById('timer-text');
            
            if (timerElement && timerBar) {
                // Format time as MM:SS
                const formattedTime = formatTime(secondsRemaining);
                timerElement.textContent = formattedTime;
                timerText.textContent = formattedTime;
                
                // Update progress bar
                const percentRemaining = (secondsRemaining / totalSeconds) * 100;
                timerBar.style.width = `${percentRemaining}%`;
                
                // Change color as time runs out
                if (percentRemaining < 25) {
                    timerBar.style.background = 'linear-gradient(90deg, rgba(255, 50, 50, 0.5), rgba(255, 50, 50, 0.8))';
                } else if (percentRemaining < 50) {
                    timerBar.style.background = 'linear-gradient(90deg, rgba(255, 183, 0, 0.5), rgba(255, 183, 0, 0.8))';
                }
            }
        }

        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;
        }

        function handleQuestFailure() {
            if (!activeQuest) return;
            
            // Apply punishment
            const xpReduction = Math.min(player.xp, activeQuest.xp);
            const punishment = activeQuest.punishment || "You failed to complete the quest in time!";
            
            // Show punishment modal
            const punishmentModal = document.getElementById('punishment-modal');
            const punishmentMessage = document.getElementById('punishment-message');
            
            punishmentMessage.textContent = `${punishment} You lost ${xpReduction} XP.`;
            punishmentModal.classList.add('active');
            
            // Reduce XP
            player.xp = Math.max(0, player.xp - xpReduction);
            
            // Update player data
            savePlayerData();
            updateHeaderInfo();
            
            // Hide timer display
            document.getElementById('timer-display').classList.add('hidden');
            
            // Reset active quest
            activeQuest = null;
            questTimer = null;
            questStartTime = null;
            timeRemaining = null;
            
            // Re-render quests page
            renderQuests();
        }

        function cancelActiveQuest() {
            if (questTimer) {
                clearInterval(questTimer);
                questTimer = null;
            }
            
            // Hide timer display
            document.getElementById('timer-display').classList.add('hidden');
            
            activeQuest = null;
            questStartTime = null;
            timeRemaining = null;
            
            // Re-render quests page
            renderQuests();
        }

        async function completeQuest() {
            if (!activeQuest) return;
            
            // Clear timer
            if (questTimer) {
                clearInterval(questTimer);
                questTimer = null;
            }
            
            // Hide timer display
            document.getElementById('timer-display').classList.add('hidden');
            
            // Calculate time spent
            const timeSpent = Math.floor((Date.now() - questStartTime) / 1000 / 60);
            
            // Mark quest as completed
            const questIndex = player.quests.findIndex(q => q.id === activeQuest.id);
            if (questIndex !== -1) {
                player.quests[questIndex].completed = true;
            }
            
            // Add to completed quests
            if (!player.completedQuests) {
                player.completedQuests = [];
            }
            
            player.completedQuests.unshift({
                ...activeQuest,
                completedAt: Date.now(),
                timeSpent
            });
            
            // Increase stats
            const statIncreases = {};
            if (activeQuest.stats && activeQuest.stats.length > 0) {
                activeQuest.stats.forEach(stat => {
                    if (player.stats[stat] !== undefined) {
                        player.stats[stat] += 1;
                        statIncreases[stat] = player.stats[stat];
                    }
                });
            }
            
            // Add XP
            const oldLevel = player.level;
            addXP(activeQuest.xp);
            
            // Check if player leveled up
            if (player.level > oldLevel) {
                showSoloLevelUpAnimation(player.level);
            }
            
            // Save player data
            await savePlayerData();
            
            // Show completion overlay
            showQuestCompleteOverlay(activeQuest, statIncreases);
            
            // Reset active quest
            activeQuest = null;
            questStartTime = null;
            timeRemaining = null;
            
            // Re-render quests page
            renderQuests();
        }

        function showQuestCompleteOverlay(quest, statIncreases) {
            const overlay = document.getElementById('quest-complete-overlay');
            const titleElement = document.getElementById('quest-complete-title');
            const xpElement = document.getElementById('quest-complete-xp');
            const statsElement = document.getElementById('quest-complete-stats');
            
            titleElement.textContent = quest.title;
            xpElement.textContent = `+${quest.xp} XP`;
            
            // Populate stats increases
            let statsHTML = '';
            for (const [stat, value] of Object.entries(statIncreases)) {
                statsHTML += `
                    <div class="flex items-center justify-between bg-[#00b7ff]/10 p-2 rounded">
                        <span class="text-[#00b7ff]/80 capitalize syncopate">${stat}</span>
                        <span class="text-[#00b7ff] font-bold orbitron">+1 (${value})</span>
                    </div>
                `;
            }
            statsElement.innerHTML = statsHTML || '<p class="text-[#00b7ff]/60">No stats increased</p>';
            
            // Show overlay with animation
            overlay.classList.add('active');
            
            // Create particles effect
            createCompletionParticles();
            
            // Update icons
            lucide.createIcons();
        }

        function createCompletionParticles() {
            const overlay = document.getElementById('quest-complete-overlay');
            const content = overlay.querySelector('.quest-complete-content');
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.style.position = 'absolute';
                    particle.style.width = '8px';
                    particle.style.height = '8px';
                    particle.style.backgroundColor = 'rgba(0, 183, 255, 0.6)';
                    particle.style.borderRadius = '50%';
                    
                    // Position at center of content
                    const rect = content.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;
                    
                    particle.style.left = `${centerX}px`;
                    particle.style.top = `${centerY}px`;
                    
                    // Random direction
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 100 + Math.random() * 150;
                    const speedFactor = 0.5 + Math.random() * 0.5;
                    
                    // Animate
                    particle.animate([
                        { 
                            transform: 'translate(-50%, -50%) scale(0)',
                            opacity: 0
                        },
                        { 
                            transform: 'translate(-50%, -50%) scale(1)',
                            opacity: 1,
                            offset: 0.1
                        },
                        { 
                            transform: `translate(calc(-50% + ${Math.cos(angle) * distance}px), calc(-50% + ${Math.sin(angle) * distance}px)) scale(0)`,
                            opacity: 0
                        }
                    ], {
                        duration: 1500 * speedFactor,
                        easing: 'cubic-bezier(0.1, 0.8, 0.2, 1)'
                    });
                    
                    overlay.appendChild(particle);
                    
                    // Remove particle after animation
                    setTimeout(() => {
                        particle.remove();
                    }, 1500);
                }, Math.random() * 500);
            }
        }

        function showSoloLevelUpAnimation(newLevel) {
            const container = document.getElementById('solo-levelup-container');
            const levelText = document.getElementById('solo-levelup-level');
            
            // Set level text
            levelText.textContent = `Level ${newLevel}`;
            
            // Create rings
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    const ring = document.createElement('div');
                    ring.classList.add('solo-levelup-ring');
                    ring.style.animationDuration = `${2 + i * 0.5}s`;
                    
                    container.appendChild(ring);
                    
                    // Remove ring after animation
                    setTimeout(() => {
                        ring.remove();
                    }, (2 + i * 0.5) * 1000);
                }, i * 300);
            }
            
            // Show container
            container.classList.add('active');
            
            // Create magic particles
            createMagicParticles(container, 50);
            
            // Hide after animation
            setTimeout(() => {
                container.classList.remove('active');
            }, 4000);
        }

        function createMagicParticles(element, count = 20) {
            const rect = element.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const particle = document.createElement('div');
                    particle.classList.add('magic-particle');
                    
                    // Random size
                    const size = 3 + Math.random() * 5;
                    particle.style.width = `${size}px`;
                    particle.style.height = `${size}px`;
                    
                    // Position at center of element
                    particle.style.left = `${centerX}px`;
                    particle.style.top = `${centerY}px`;
                    
                    // Random direction and distance
                    const tx = (Math.random() - 0.5) * rect.width * 2;
                    const ty = (Math.random() - 0.5) * rect.height * 2;
                    const rotation = Math.random() * 360;
                    const duration = 1 + Math.random() * 2;
                    
                    particle.style.setProperty('--tx', `${tx}px`);
                    particle.style.setProperty('--ty', `${ty}px`);
                    particle.style.setProperty('--r', `${rotation}deg`);
                    particle.style.setProperty('--duration', `${duration}s`);
                    
                    document.body.appendChild(particle);
                    
                    // Remove particle after animation
                    setTimeout(() => {
                        particle.remove();
                    }, duration * 1000);
                }, Math.random() * 500);
            }
        }

        function addXP(amount) {
            const oldLevel = player.level;
            player.xp += amount;
            
            // Check for level up
            const newLevel = Math.floor(player.xp / XP_PER_LEVEL) + 1;
            if (newLevel > player.level) {
                // Level up!
                player.level = newLevel;
                player.rank = getRankForLevel(newLevel);
                
                // Show level up notification
                if (player.settings && player.settings.notifications) {
                    showLevelUpNotification(newLevel);
                }
            }
            
            // Update header info
            updateHeaderInfo();
        }

        function showLevelUpNotification(level) {
            const notification = document.getElementById('level-up-notification');
            const text = document.getElementById('level-up-notification-text');
            
            text.textContent = `You've reached level ${level}!`;
            notification.classList.add('active');
            
            setTimeout(() => {
                notification.classList.remove('active');
            }, 5000);
        }

        function renderRewards() {
            const rewardsContent = `
                <div class="space-y-6">
                    <div class="flex justify-between items-center">
                        <h2 class="text-2xl font-bold text-[#00b7ff] glow-text solo-text orbitron">Rewards</h2>
                        <div class="flex items-center space-x-4">
                            <div class="flex items-center space-x-2 bg-[#00b7ff]/10 px-3 py-1 rounded-full">
                                <i data-lucide="star" class="text-[#00b7ff] w-5 h-5"></i>
                                <span class="text-[#00b7ff] font-bold orbitron">${player.xp} XP</span>
                            </div>
                            <button 
                                onclick="navigateTo('create-reward')" 
                                class="px-4 py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider flex items-center space-x-2 btn-primary"
                            >
                                <i data-lucide="plus" class="w-4 h-4"></i>
                                <span>NEW REWARD</span>
                            </button>
                        </div>
                    </div>

                    <!-- Customized Rewards -->
                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">Customized Rewards</div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            ${player.rewards.map(reward => `
                                <div class="bg-black/60 p-4 rounded border border-[#00b7ff]/30 quest-card holographic-ui">
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center space-x-2">
                                            <div class="w-10 h-10 rounded-full bg-[#00b7ff]/10 flex items-center justify-center">
                                                <i data-lucide="${reward.icon}" class="w-5 h-5 text-[#00b7ff]"></i>
                                            </div>
                                            <h3 class="text-lg font-semibold text-[#00b7ff] orbitron">${reward.title}</h3>
                                        </div>
                                        <span class="text-[#00b7ff]/70 orbitron">${reward.cost} XP</span>
                                    </div>
                                    <p class="text-[#00b7ff]/60 mt-2">${reward.description}</p>
                                    <div class="flex space-x-2 mt-4">
                                        <button 
                                            onclick="claimReward('${reward.id}')"
                                            class="flex-1 py-2 rounded border transition-colors tracking-wider ${
                                                player.xp >= reward.cost
                                                    ? 'bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] border-[#00b7ff]/30 btn-primary'
                                                    : 'bg-gray-800/50 text-gray-500 border-gray-700 cursor-not-allowed'
                                            }"
                                            ${player.xp < reward.cost ? 'disabled' : ''}
                                        >
                                            ${player.xp >= reward.cost ? 'CLAIM REWARD' : 'INSUFFICIENT XP'}
                                        </button>
                                        ${reward.custom ? `
                                            <button 
                                                onclick="deleteReward('${reward.id}')"
                                                class="py-2 px-3 bg-black/60 hover:bg-red-900/30 text-[#00b7ff]/70 hover:text-red-400 rounded border border-[#00b7ff]/30 transition-colors"
                                            >
                                                <i data-lucide="trash-2" class="w-5 h-5"></i>
                                            </button>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">Claimed Rewards</div>
                        ${player.claimedRewards && player.claimedRewards.length > 0 ? `
                            <div class="space-y-3">
                                ${player.claimedRewards.map(reward => `
                                    <div class="bg-black/60 p-3 rounded border border-[#00b7ff]/30 flex justify-between items-center quest-card">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-8 h-8 rounded-full bg-[#00b7ff]/10 flex items-center justify-center">
                                                ${reward.image ? 
                                                    `<img src="${reward.image}" alt="${reward.title}" class="w-7 h-7 rounded-full object-cover">` :
                                                    `<i data-lucide="${reward.icon}" class="w-4 h-4 text-[#00b7ff]"></i>`
                                                }
                                            </div>
                                            <div>
                                                <h4 class="text-[#00b7ff] orbitron">${reward.title}</h4>
                                                <p class="text-[#00b7ff]/60 text-sm">${new Date(reward.claimedAt).toLocaleString()}</p>
                                            </div>
                                        </div>
                                        <div class="text-[#00b7ff]/70 orbitron">-${reward.cost} XP</div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <p class="text-[#00b7ff]/60">No rewards claimed yet. Use your XP to claim rewards!</p>
                        `}
                    </div>
                </div>
            `;

            document.getElementById('rewards-page').innerHTML = rewardsContent;
            lucide.createIcons();
        }

        async function claimReward(rewardId) {
            const reward = player.rewards.find(r => r.id === rewardId);
            if (!reward) return;
            
            // Check if player has enough XP
            if (player.xp < reward.cost) {
                showNotification('Insufficient XP', 'You do not have enough XP to claim this reward.');
                return;
            }
            
            // Deduct XP
            player.xp -= reward.cost;
            
            // Add to claimed rewards
            if (!player.claimedRewards) {
                player.claimedRewards = [];
            }
            
            player.claimedRewards.unshift({
                ...reward,
                claimedAt: Date.now()
            });
            
            // Save player data
            await savePlayerData();
            
            // Update header info
            updateHeaderInfo();
            
            // Re-render rewards page
            renderRewards();
            
            // Show success message with Solo Leveling style
            showRewardClaimedAnimation(reward);
        }

        function showRewardClaimedAnimation(reward) {
            // Create a temporary overlay
            const overlay = document.createElement('div');
            overlay.style.position = 'fixed';
            overlay.style.top = '0';
            overlay.style.left = '0';
            overlay.style.width = '100%';
            overlay.style.height = '100%';
            overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
            overlay.style.display = 'flex';
            overlay.style.alignItems = 'center';
            overlay.style.justifyContent = 'center';
            overlay.style.zIndex = '100';
            overlay.style.opacity = '0';
            overlay.style.transition = 'opacity 0.3s ease';
            
            // Create content
            const content = document.createElement('div');
            content.style.textAlign = 'center';
            content.style.color = '#00b7ff';
            content.style.padding = '2rem';
            content.style.borderRadius = '10px';
            content.style.backgroundColor = 'rgba(0, 20, 40, 0.9)';
            content.style.border = '2px solid rgba(0, 183, 255, 0.5)';
            content.style.boxShadow = '0 0 30px rgba(0, 183, 255, 0.4)';
            content.style.transform = 'scale(0.8)';
            content.style.transition = 'transform 0.5s ease';
            content.className = 'holographic-ui';
            
            content.innerHTML = `
                <div class="solo-text text-3xl font-bold mb-4 orbitron">Reward Claimed!</div>
                <div class="w-16 h-16 mx-auto mb-4 rounded-full bg-[#00b7ff]/20 flex items-center justify-center pulse-glow">
                    ${reward.image ? 
                        `<img src="${reward.image}" alt="${reward.title}" class="w-14 h-14 rounded-full object-cover">` :
                        `<i data-lucide="${reward.icon}" class="w-8 h-8 text-[#00b7ff]"></i>`
                    }
                </div>
                <div class="text-2xl font-bold mb-2 orbitron">${reward.title}</div>
                <div class="text-[#00b7ff]/70 mb-6">${reward.description}</div>
                <button class="px-6 py-2 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary">
                    CONTINUE
                </button>
            `;
            
            overlay.appendChild(content);
            document.body.appendChild(overlay);
            
            // Create magic particles
            createMagicParticles(content, 30);
            
            // Show overlay
            setTimeout(() => {
                overlay.style.opacity = '1';
                content.style.transform = 'scale(1)';
            }, 100);
            
            // Update icons
            lucide.createIcons();
            
            // Add event listener to close button
            const button = content.querySelector('button');
            button.addEventListener('click', () => {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.remove();
                }, 300);
            });
            
            // Auto close after 5 seconds
            setTimeout(() => {
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.remove();
                }, 300);
            }, 5000);
        }

        function deleteReward(rewardId) {
            showNotification(
                'Delete Reward', 
                'Are you sure you want to delete this reward?', 
                async () => {
                    player.rewards = player.rewards.filter(r => r.id !== rewardId);
                    await savePlayerData();
                    renderRewards();
                }
            );
        }

        function renderCreateQuest() {
            const createQuestContent = `
                <div class="space-y-6">
                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">Create New Quest</div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Quest Title</label>
                                <input
                                    type="text"
                                    id="quest-title"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] orbitron"
                                    placeholder="Enter quest title"
                                />
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Description</label>
                                <textarea
                                    id="quest-description"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] h-24"
                                    placeholder="Enter quest description"
                                ></textarea>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="text-[#00b7ff]/80 block mb-2 syncopate">XP Reward</label>
                                    <input
                                        type="number"
                                        id="quest-xp"
                                        value="100"
                                        class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] orbitron"
                                        min="0"
                                    />
                                </div>

                                <div>
                                    <label class="text-[#00b7ff]/80 block mb-2 syncopate">Time Limit (minutes)</label>
                                    <input
                                        type="number"
                                        id="quest-time"
                                        value="30"
                                        class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] orbitron"
                                        min="0"
                                    />
                                </div>
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Category</label>
                                <select
                                    id="quest-category"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] orbitron"
                                >
                                    <option value="physical">Physical</option>
                                    <option value="mental">Mental</option>
                                    <option value="health">Health</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Punishment (if quest fails)</label>
                                <textarea
                                    id="quest-punishment"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] h-24"
                                    placeholder="Enter punishment for failing the quest"
                                    defaultValue="You failed to complete the quest in time!"
                                ></textarea>
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Stats to Improve</label>
                                <div class="grid grid-cols-2 md:grid-cols-3 gap-2">
                                    <label class="flex items-center space-x-2 bg-black/40 p-2 rounded cursor-pointer hover:bg-black/60">
                                        <input type="checkbox" name="stats" value="strength" class="accent-[#00b7ff]">
                                        <span class="text-[#00b7ff]/80 syncopate">Strength</span>
                                    </label>
                                    <label class="flex items-center space-x-2 bg-black/40 p-2 rounded cursor-pointer hover:bg-black/60">
                                        <input type="checkbox" name="stats" value="endurance" class="accent-[#00b7ff]">
                                        <span class="text-[#00b7ff]/80 syncopate">Endurance</span>
                                    </label>
                                    <label class="flex items-center space-x-2 bg-black/40 p-2 rounded cursor-pointer hover:bg-black/60">
                                        <input type="checkbox" name="stats" value="focus" class="accent-[#00b7ff]">
                                        <span class="text-[#00b7ff]/80 syncopate">Focus
                                        </span>
                                    </label>
                                    <label class="flex items-center space-x-2 bg-black/40 p-2 rounded cursor-pointer hover:bg-black/60">
                                        <input type="checkbox" name="stats" value="discipline" class="accent-[#00b7ff]">
                                        <span class="text-[#00b7ff]/80 syncopate">Discipline</span>
                                    </label>
                                    <label class="flex items-center space-x-2 bg-black/40 p-2 rounded cursor-pointer hover:bg-black/60">
                                        <input type="checkbox" name="stats" value="agility" class="accent-[#00b7ff]">
                                        <span class="text-[#00b7ff]/80 syncopate">Agility</span>
                                    </label>
                                    <label class="flex items-center space-x-2 bg-black/40 p-2 rounded cursor-pointer hover:bg-black/60">
                                        <input type="checkbox" name="stats" value="intelligence" class="accent-[#00b7ff]">
                                        <span class="text-[#00b7ff]/80 syncopate">Intelligence</span>
                                    </label>
                                </div>
                            </div>

                            <button
                                onclick="createNewQuest()"
                                class="mt-4 w-full py-3 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary"
                            >
                                CREATE QUEST
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('create-quest-page').innerHTML = createQuestContent;
            lucide.createIcons();
        }

        function renderCreateReward() {
            const icons = [
                'pizza', 'gamepad-2', 'film', 'moon', 'coffee', 'music', 'shopping-bag', 'tv', 
                'book', 'car', 'gift', 'ice-cream', 'beer', 'cake', 'smartphone', 'headphones'
            ];
            
            const createRewardContent = `
                <div class="space-y-6">
                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">Create Custom Reward</div>
                        
                        <div class="space-y-4">
                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Reward Title</label>
                                <input
                                    type="text"
                                    id="reward-title"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] orbitron"
                                    placeholder="Enter reward title"
                                    oninput="updateRewardPreview()"
                                />
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Description</label>
                                <textarea
                                    id="reward-description"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] h-24"
                                    placeholder="Enter reward description"
                                    oninput="updateRewardPreview()"
                                ></textarea>
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">XP Cost</label>
                                <input
                                    type="number"
                                    id="reward-cost"
                                    value="100"
                                    class="w-full px-3 py-2 bg-black/60 text-[#00b7ff] border border-[#00b7ff]/30 rounded focus:outline-none focus:border-[#00b7ff] focus:ring-1 focus:ring-[#00b7ff] orbitron"
                                    min="0"
                                    oninput="updateRewardPreview()"
                                />
                            </div>

                            <div>
                                <label class="text-[#00b7ff]/80 block mb-2 syncopate">Select Icon</label>
                                <div class="reward-icon-grid">
                                    ${icons.map(icon => `
                                        <div class="reward-icon-option ${icon === 'gift' ? 'selected' : ''}" data-icon="${icon}" onclick="selectRewardIcon(this)">
                                            <i data-lucide="${icon}" class="w-6 h-6 text-[#00b7ff]"></i>
                                        </div>
                                    `).join('')}
                                </div>
                                <input type="hidden" id="reward-icon" value="gift">
                            </div>

                            <div class="reward-preview holographic-ui">
                                <h3 class="text-[#00b7ff] mb-2 syncopate">Preview</h3>
                                <div class="bg-black/60 p-4 rounded border border-[#00b7ff]/30">
                                    <div class="flex justify-between items-center">
                                        <div class="flex items-center space-x-2">
                                            <div class="w-10 h-10 rounded-full bg-[#00b7ff]/10 flex items-center justify-center">
                                                <i id="preview-icon" data-lucide="gift" class="w-5 h-5 text-[#00b7ff]"></i>
                                            </div>
                                            <h3 id="preview-title" class="text-lg font-semibold text-[#00b7ff] orbitron">Reward Title</h3>
                                        </div>
                                        <span id="preview-cost" class="text-[#00b7ff]/70 orbitron">100 XP</span>
                                    </div>
                                    <p id="preview-description" class="text-[#00b7ff]/60 mt-2">Reward description</p>
                                </div>
                            </div>

                            <button
                                onclick="createNewReward()"
                                class="mt-4 w-full py-3 bg-[#00b7ff]/20 hover:bg-[#00b7ff]/30 text-[#00b7ff] rounded border border-[#00b7ff]/30 transition-colors tracking-wider btn-primary"
                            >
                                CREATE REWARD
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('create-reward-page').innerHTML = createRewardContent;
            lucide.createIcons();
        }

        function updateRewardPreview() {
            const title = document.getElementById('reward-title').value || 'Reward Title';
            const description = document.getElementById('reward-description').value || 'Reward description';
            const cost = document.getElementById('reward-cost').value || '100';
            const icon = document.getElementById('reward-icon').value;
            
            document.getElementById('preview-title').textContent = title;
            document.getElementById('preview-description').textContent = description;
            document.getElementById('preview-cost').textContent = `${cost} XP`;
            
            // Update icon
            const previewIcon = document.getElementById('preview-icon');
            previewIcon.setAttribute('data-lucide', icon);
            lucide.createIcons();
        }

        function selectRewardIcon(element) {
            // Remove selected class from all icons
            document.querySelectorAll('.reward-icon-option').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Add selected class to clicked icon
            element.classList.add('selected');
            
            // Update hidden input
            document.getElementById('reward-icon').value = element.dataset.icon;
            
            // Update preview
            updateRewardPreview();
        }

        function renderSettings() {
            const settingsContent = `
                <div class="space-y-6">
                    <div class="bg-black/80 backdrop-blur-lg p-6 rounded-lg border border-[#00b7ff]/30 shadow-[0_0_15px_rgba(0,183,255,0.3)] cyberpunk-border holographic-ui">
                        <div class="holographic-header">System Settings</div>
                        
                        <div
